# Kube State Metrics Helm Values
# Chart: https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-state-metrics

fullnameOverride: kube-state-metrics

resources:
  requests:
    cpu: 10m
    memory: 64Mi

service:
  type: ClusterIP
  clusterIP: None

# Prometheus ServiceMonitor 설정
prometheus:
  monitor:
    enabled: true
    additionalLabels:
      release: prometheus
    namespace: monitoring
    relabelings:
      - targetLabel: cluster
        replacement: "mayne-cluster"
    # exported_* 레이블을 표준 레이블로 복사하여 Grafana 대시보드 호환성 확보
    metricRelabelings:
      - sourceLabels: [exported_namespace]
        targetLabel: namespace
        regex: (.+)
        replacement: ${1}
      - sourceLabels: [exported_pod]
        targetLabel: pod
        regex: (.+)
        replacement: ${1}
      - sourceLabels: [exported_container]
        targetLabel: container
        regex: (.+)
        replacement: ${1}
